<!DOCTYPE html>

<label for=url>url:</label>
<input type=text id=url name=url>
<br>
<label for=speed>speed:</label>
<input type=number id=speed name=speed value=1.0 step=0.1>
<br>
<label for=filetype>file type:</label>
<select id=filetype name=filetype>
  <option>mp3</option>
  <option>mp4</option>
</select>
<br>
<button>download</button>

<script>
const button = document.querySelector('button');
button.onclick = async () => {
  const url = document.getElementById('url').value;
  const speed = document.getElementById('speed').value;
  const filetype = document.getElementById('filetype').value;
  const options = {
    headers: {
      accept: '*/*'
    }
  };
  const response = await fetch(
    '/slowmedownload?' + new URLSearchParams({url, speed, filetype}).toString(), options);
  const blob = await response.blob();
  const file = window.URL.createObjectURL(blob);
  window.location.assign(file);
};
</script>
